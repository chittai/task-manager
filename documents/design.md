# TaskManager 機能要件定義書 (**v1.2**)

## 1. 概要

本ドキュメントは、TaskManager アプリケーションの機能要件を定義するものである。
本アプリケーションは、ユーザーがタスクを管理するための Web アプリケーションであり、Getting Things Done (GTD) の考え方を取り入れ、効率的なタスク処理を支援するとともに、各タスクの対応履歴を記録・確認できることを目指す。

## 2. 機能要件

### 2.1. タスク表示機能

-   FR-001: 登録されているタスクの一覧を表示できること。(変更なし)
-   FR-002: 各タスクについて、以下の情報を表示または保持していること。
    -   タイトル (`title`)
    -   説明 (`description`)
    -   ステータス (`status`: 'inbox','todo', 'in-progress', 'done', 'wait-on' のいずれか。)
    -   優先度 (`priority`: 'low', 'medium', 'high' のいずれか)
    -   期限日 (`dueDate`, オプション)
    -   作成日時 (`createdAt`)
    -   更新日時 (`updatedAt`)
    -   プロジェクト (`projectId`, オプション、関連するプロジェクトID)
    -   コメントリスト (`comments`, オプション、Comment オブジェクトの配列)
-   FR-003: アプリケーション起動時やデータ読み込み中に、ローディング状態を示す表示を行うこと。
-   FR-004: タスク一覧をフィルタリング（例: コンテキスト別、プロジェクト別、ステータス別）できること。
-   FR-005: タスク一覧をソート（例: 期限日順、優先度順、作成日時順）できること。

### 2.2. タスク追加機能 (**GTD: 収集・処理フェーズ**)

-   FR-006: 新しいタスクを追加するためのインターフェース（例: クイック追加バー、モーダルウィンドウ）を提供すること。特に、未整理のアイデアやタスクを素早く「インボックス」に追加できること。
-   FR-007: タスク追加時に、以下の情報を入力できること。
    -   タイトル
    -   （オプション）説明
    -   （オプション）プロジェクト
    -   （オプション）ステータス (デフォルトは 'inbox')
    -   （オプション）優先度
    -   （オプション）期限日
-   FR-008: タスク追加時に、システムは以下を自動的に設定すること。
    -   一意のタスクID (`id`)
    -   作成日時 (`createdAt`)
    -   更新日時 (`updatedAt`)
-   FR-009: 追加されたタスクはタスク一覧（またはインボックス画面）に表示されること。

### 2.3. タスク編集・整理機能 (**GTD: 処理・整理フェーズ**)

-   FR-010: 既存のタスクを選択し、編集するためのインターフェース（モーダルウィンドウ）を提供すること。インボックス内のタスクを処理・整理する際にも使用する。
-   FR-011: タスク編集時に、以下の情報を変更できること。
    -   タイトル
    -   説明
    -   ステータス
    -   優先度
    -   期限日
    -   プロジェクト
-   FR-012: タスク編集時に、システムは更新日時 (`updatedAt`) を自動的に更新すること。
-   FR-013: 編集されたタスクの情報はタスク一覧に反映されること。

### 2.4. タスク削除機能

-   FR-014: 既存のタスクを選択し、削除できること。
-   FR-015: タスク削除前に、確認メッセージを表示すること。
-   FR-016: 削除されたタスクはタスク一覧から除去されること。

### 2.5. タスクステータス変更機能 (**GTD: 実行フェーズ**)

-   FR-017: タスク一覧画面などから、直接タスクのステータス ('todo', 'in-progress', 'done') を変更できること。
-   FR-018: ステータス変更時、システムは更新日時 (`updatedAt`) を自動的に更新すること。

### 2.6. データ永続化機能

-   FR-019: 作成・編集・削除されたタスク情報は、ブラウザを閉じたりリロードしたりしても保持されること (現時点ではブラウザの LocalStorage を使用)。

### 2.7. プロジェクト管理機能

-   FR-020: プロジェクトを作成、編集、削除できること。
-   FR-021: 各プロジェクトに属するタスクの一覧を表示できること。

### 2.8. タスク履歴・コメント機能

-   FR-022: 各タスクの詳細画面（またはモーダル内）で、コメントを追加するためのインターフェースを提供すること。
-   FR-023: コメント追加時には、コメント内容と共にシステムが自動的に追加日時（および可能であればユーザー情報）を記録すること。
-   FR-024: 各タスクに関連するコメントの履歴を、時系列（新しいものが上または下）で表示できること。

### 2.9. GTDレビュー支援機能

-   FR-026: 定期的なレビュー（週次レビューなど）をサポートする機能を提供すること（例: 特定のタグが付いたタスクの一覧表示、インボックス内の未処理タスクのリマインドなど）。

## 3. データモデル

本アプリケーションで利用する主要なデータモデルは以下の通りです。

### 3.1. Task

タスク情報を表します。

```typescript
interface Task {
  id: string; // 一意の識別子
  title: string; // タスクのタイトル
  description: string; // タスクの詳細説明
  status: 'inbox' | 'todo' | 'in-progress' | 'done' | 'wait-on'; // タスクのステータス
  priority: 'low' | 'medium' | 'high'; // タスクの優先度
  dueDate?: string; // 期限日 (ISO 8601 format, オプション)
  createdAt: string; // 作成日時 (ISO 8601 format)
  updatedAt: string; // 最終更新日時 (ISO 8601 format)
  projectId?: string; // 関連プロジェクトのID (オプション)
  comments?: Comment[]; // タスクに関連するコメントの配列 (オプション)
}
```

### 3.2. Comment

タスクへのコメント情報を表します。

```typescript
interface Comment {
  id: string; // 一意の識別子
  taskId: string; // 関連タスクのID
  content: string; // コメント内容
  createdAt: string; // 作成日時 (ISO 8601 format)
  userId?: string; // コメント作成者のID (オプション)
}
```

### 3.3. Project

プロジェクト情報を表します。

```typescript
interface Project {
  id: string; // 一意の識別子
  name: string; // プロジェクト名
  description?: string; // プロジェクトの説明 (オプション)
  createdAt: string; // 作成日時 (ISO 8601 format)
  updatedAt: string; // 最終更新日時 (ISO 8601 format)
}
```

## 4. 主要コンポーネント/モジュール構成

### 4.1. モデル (src/models/)

-   `Task.ts`: タスクのデータ構造 (Task インターフェース) を定義します。
-   `Comment.ts`: コメントのデータ構造 (Comment インターフェース) を定義します。
-   `Project.ts`: プロジェクトのデータ構造 (Project インターフェース) を定義します。

### 4.2. フック (src/hooks/)

-   `useTasks.ts` (仮): タスクデータに関する状態管理とCRUD操作（LocalStorage利用）を提供します。(Issue #2 で実装予定)
-   `useProjects.ts`: プロジェクトデータに関する状態管理とCRUD操作（LocalStorage利用）を提供します。

### 4.3. UIコンポーネント (src/components/)

-   `TaskList.tsx` (仮): タスク一覧の表示と操作を行います。(Issue #2 で実装予定)
-   `TaskForm.tsx` (仮): タスクの追加・編集フォームを提供します。(Issue #2 で実装予定)
-   `ProjectList.tsx`: プロジェクト一覧の表示と操作（編集・削除ボタンの配置）を行います。
-   `ProjectForm.tsx`: プロジェクトの追加・編集フォームを提供します。
